<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QuickConvert - Free & Fast Online Image, Text, PDF, Markdown Converter</title>
  <meta name="description" content="QuickConvert is a free, fast, and powerful online converter for images (JPG, PNG, WebP), text (JSON, CSV, TXT), PDFs (merge, extract text), and Markdown files. Convert everything in seconds — no signup, no hassle.">
  <meta name="keywords" content="Image Converter, JPG to PNG, PNG to JPG, WebP Converter, Compress Image, Resize Image, JSON Formatter, JSON to CSV, CSV to JSON, TXT to PDF, Merge PDFs, Extract Text from PDF, Markdown to HTML, Markdown to PDF, Convert Images to PDF, Free Online Converter, QuickConvert">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gif.js.optimized/dist/gif.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.2/mammoth.browser.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/js-beautify@1.14.0/js/lib/beautify-html.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.0.2/dist/tesseract.min.js"></script>
  <style>
/* 背景渐变更高级 */
body {
  background: linear-gradient(to right, #6a11cb, #2575fc); /* 蓝紫渐变，提升高级感 */
  font-family: 'Poppins', Arial, sans-serif;
  padding: 20px;
  color: #333;
  scroll-behavior: smooth; /* 平滑滚动 */
}

/* 主容器 */
.container {
  background: white;
  border-radius: 20px;
  padding: 30px;
  max-width: 1200px;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.1); /* 阴影更柔和一点 */
}

/* 顶部大标题 */
h1 {
  color: #003366;
  font-family: 'Poppins', sans-serif;
  font-size: 48px;
  font-weight: bold;
  margin-bottom: 30px;
}

/* 小标题 */
h2 {
  color: #004080;
  font-weight: bold;
  font-size: 32px; /* 稍微放大，更有层级感 */
  margin-top: 20px;
  margin-bottom: 20px;
}

h2 i {
  margin-right: 8px;
  color: #2575fc; /* 图标蓝色，和你整体风格统一 */
  font-size: 28px; /* 和标题文字差不多大小 */
  vertical-align: middle;
}

/* 表单label文字 */
label {
  font-weight: bold;
  color: #007bff;
  font-size: 18px;
  margin-bottom: 5px;
}

/* 自定义按钮 */
.btn-custom {
  background: linear-gradient(to right, #4facfe, #00f2fe);
  border: none;
  color: white;
  font-weight: bold;
  padding: 10px 20px;
  margin: 10px;
  border-radius: 8px;
  transition: transform 0.3s ease, background 0.3s ease;
}

.btn-custom:hover {
  transform: scale(1.05); /* hover时轻微放大 */
  background: linear-gradient(to right, #2575fc, #6a11cb); /* hover时渐变变换 */
}

/* Tab内容区 */
.tab-content {
  margin-top: 20px;
}

/* 隐藏元素 */
.hidden {
  display: none;
}

/* 文本区域（比如文本输入框） */
textarea {
  width: 100%;
  height: 200px;
  margin-bottom: 10px;
  border-radius: 10px;
  padding: 10px;
  border: 1px solid #ccc; /* 加细细的灰色边框，更规范 */
}

/* 预格式化文本（比如转换结果展示区） */
pre {
  background: #f2f2f2;
  padding: 15px;
  border-radius: 10px;
  max-height: 300px;
  overflow: auto;
}

/* 各个功能块section */
.section {
  background: #f0f4ff; /* 非常浅的蓝灰色 */
  padding: 20px;
  border-radius: 15px;
  margin-bottom: 20px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); /* 小柔光阴影，立体感 */
}

/* 预览图片样式 */
.preview img {
  max-width: 100%;
  margin: 5px;
  border-radius: 10px;
  border: 1px solid #eee; /* 加细细的边框，让图片更规整 */
}

/* 图片容器居中 */
.preview .img-container {
  text-align: center;
  margin: 10px;
}

/* 页脚footer */
footer {
  text-align: center;
  color: #aaa;
  font-size: 14px;
  margin-top: 50px;
  margin-bottom: 20px;
}

.tool-chip {
  display: inline-block;
  background: #f0f4ff; /* 淡蓝色 */
  color: #003366; /* 深蓝色，柔和统一 */
  font-weight: bold;
  padding: 10px 18px;
  margin: 8px;
  border-radius: 30px;
  text-decoration: none;
  transition: all 0.3s ease;
  font-size: 16px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

.tool-chip i {
  margin-right: 6px;
  font-size: 18px;
  vertical-align: middle;
}

.tool-chip:hover {
  background: #2575fc;
  color: #fff;
  box-shadow: 0 6px 15px rgba(0,0,0,0.15);
  transform: translateY(-3px);
}

.chips-container {
  display: flex;
  flex-wrap: wrap; /* 自动换行 */
  justify-content: center; /* 居中排列 */
  gap: 12px; /* 每个chip之间的间距 */
  margin-top: 20px;
}

p.small.text-muted {
  margin-top: -10px;
  margin-bottom: 20px;
  font-size: 14px;
}

  </style>
</head>

<body>

<div class="container">
  <h1 class="text-center mb-4">QuickConvert</h1>

  <div class="text-center">
    <button class="btn btn-custom" onclick="showTab('image')">Image Conversion</button>
    <button class="btn btn-custom" onclick="showTab('text')">Text Conversion</button>
  </div>

  <!-- Image Conversion Tab -->
<div id="imageTab" class="tab-content">
<div class="section">
  <h2 class="text-center mb-3">Quick Tools Index(Image)</h2>
  <p class="small text-center text-muted">
    Supported formats: JPG, PNG, WEBP
  </p>
  <div class="row g-4 text-center">
    <div class="chips-container">
      <!-- Chips列表开始 -->
    <a href="#convertSingleImageSection" class="tool-chip">
      <i class="fas fa-image"></i> Convert Single Image
    </a>

    <a href="#convertMultipleImagesSection" class="tool-chip">
      <i class="fas fa-images"></i> Convert Multiple Images
    </a>

    <a href="#compressImageSection" class="tool-chip">
      <i class="fas fa-compress-arrows-alt"></i> Compress Images
    </a>

    <a href="#resizeImageSection" class="tool-chip">
      <i class="fas fa-expand-arrows-alt"></i> Resize Images
    </a>

    <a href="#pdfToJPGSection" class="tool-chip">
      <i class="fas fa-file-pdf"></i> PDF to JPG
    </a>

    <a href="#imagesToPDFSection" class="tool-chip">
      <i class="fas fa-file-upload"></i> Combine Images to PDF
    </a>
    </div>
  </div>
</div>

  
  <div class="row g-4">

    <!-- Convert Single Image -->
    <div class="col-md-6">
      <div id="convertSingleImageSection" class="section">
        <h2 class="text-center mb-3"><i class="fas fa-image"></i>Convert Single Image</h2>
        <input type="file" id="singleFileInput" class="form-control mb-3" accept="image/png, image/jpeg, image/webp" />
        <select id="singleFormatSelect" class="form-select mb-3">
          <option value="image/jpeg">Convert to JPG</option>
          <option value="image/png">Convert to PNG</option>
          <option value="image/webp">Convert to WEBP</option>
        </select>
        <div class="mb-3">
          <label>Resize (optional):</label>
          <div class="d-flex gap-2">
            <input type="number" id="resizeWidth" class="form-control" placeholder="Width (px)" />
            <input type="number" id="resizeHeight" class="form-control" placeholder="Height (px)" />
          </div>
        </div>
        <button onclick="previewSingleImage()" class="btn btn-custom mb-3">Preview</button>
        <div id="singlePreview" class="preview"></div>
        <div id="singleDownload" class="text-center mt-3"></div>
      </div>
    </div>

    <!-- Convert Multiple Images -->
    <div class="col-md-6">
      <div id="convertMultipleImagesSection" class="section">
        <h2 class="text-center mb-3"><i class="fas fa-images"></i>Convert Multiple Images</h2>
        <input type="file" id="batchFileInput" class="form-control mb-3" multiple accept="image/png, image/jpeg, image/webp" />
        <select id="batchFormatSelect" class="form-select mb-3">
          <option value="image/jpeg">Convert to JPG</option>
          <option value="image/png">Convert to PNG</option>
          <option value="image/webp">Convert to WEBP</option>
        </select>
        <div class="mb-3">
          <label>Batch Resize (optional):</label>
          <div class="d-flex gap-2">
            <input type="number" id="batchResizeWidth" class="form-control" placeholder="Width (px)" />
            <input type="number" id="batchResizeHeight" class="form-control" placeholder="Height (px)" />
          </div>
        </div>
        <button onclick="convertBatchImages()" class="btn btn-custom mb-3">Batch Convert</button>
        <div id="batchPreview" class="preview d-flex flex-wrap justify-content-center"></div>
      </div>
    </div>

    <!-- Compress Image -->
    <div class="col-md-6">
      <div id="compressImageSection" class="section">
        <h2 class="text-center mb-3"><i class="fas fa-compress-arrows-alt"></i>Compress Image</h2>
        <input type="file" id="compressFileInput" class="form-control mb-3" accept="image/png, image/jpeg, image/webp" />
        <select id="compressQuality" class="form-select mb-3">
          <option value="0.9">90% Quality</option>
          <option value="0.7">70% Quality</option>
          <option value="0.5">50% Quality</option>
          <option value="0.3">30% Quality</option>
        </select>
        <button onclick="compressImage()" class="btn btn-custom mb-3">Compress</button>
        <div id="compressPreview" class="preview"></div>
        <div id="compressDownload" class="text-center mt-3"></div>
      </div>
    </div>

    <!-- Resize Image -->
    <div class="col-md-6">
      <div id="resizeImageSection" class="section">
        <h2 class="text-center mb-3"><i class="fas fa-expand-arrows-alt"></i>Resize Image</h2>
        <input type="file" id="resizeImageInput" class="form-control mb-3" accept="image/png, image/jpeg, image/webp" />
        <div class="d-flex gap-2 mb-3">
          <input type="number" id="resizeWidthInput" class="form-control" placeholder="Width (px)">
          <input type="number" id="resizeHeightInput" class="form-control" placeholder="Height (px)">
        </div>
        <div class="text-center">
          <button onclick="resizeImage()" class="btn btn-custom mb-3">Resize</button>
        </div>
        <div id="resizeImagePreview" class="preview text-center"></div>
      </div>
    </div>

  </div>

  <!-- 单独排一行的大模块区 -->
  <div class="row g-4 mt-4">

    <!-- PDF to JPG -->
    <div class="col-12">
      <div id="pdfToJPGSection" class="section">
        <h2 class="text-center mb-3"><i class="fas fa-file-pdf"></i>PDF to JPG</h2>
        <input type="file" id="pdfFileInput" class="form-control mb-3" accept="application/pdf" />
        <button onclick="convertPdfToJpg()" class="btn btn-custom mb-3">Convert PDF</button>
        <div id="pdfPreview" class="preview"></div>
        <div id="pdfDownload" class="text-center mt-3"></div>
      </div>
    </div>

    <!-- Images to PDF -->
    <div class="col-12">
      <div id="imagesToPDFSection" class="section">
        <h2 class="text-center mb-3"><i class="fas fa-file-upload"></i>Images to PDF</h2>
        <input type="file" id="imagesPdfInput" class="form-control mb-3" multiple accept="image/png, image/jpeg, image/webp" />
        <p class="text-muted small text-center mt-2">
          Recommended: Upload up to 15-20 images. Each image under 2MB. Total PDF size under 50MB for best performance. JPG, PNG, and WebP formats are supported.
        </p>
        <div class="text-center">
          <button onclick="convertImagesToPdf()" class="btn btn-custom mb-3">Convert to PDF</button>
        </div>
        <div id="imagesPdfPreview" class="preview d-flex flex-wrap justify-content-center"></div>
      </div>
    </div>

    <!-- Image OCR (Extract Text) -->
  <div class="col-12">
  <div id="imageOcrSection" class="section">
    <h2 class="text-center mb-3"><i class="fas fa-file-alt"></i> Image OCR (Extract Text from Images)</h2>

    <input type="file" id="ocrFileInput" class="form-control mb-3" accept="image/png, image/jpeg" />

    <p class="text-muted small text-center mt-2">
      Supported formats: JPG, PNG. For best results, use clear, high-quality images with text.
    </p>

    <div class="text-center">
      <button onclick="performOcr()" class="btn btn-custom mb-3">Extract Text</button>
    </div>

    <div id="ocrResult" class="p-3 bg-light rounded" style="min-height: 200px; overflow: auto;"></div>
  </div>
  </div>
 
  </div>
</div>

  
  <!-- Text Conversion Tab -->
  <div id="textTab" class="tab-content hidden">
  <div class="section">
  <h2 class="text-center mb-3">Quick Tools Index(Text)</h2>
    <div class="chips-container">

    <a href="#mergePdfsSection" class="tool-chip">
      <i class="fas fa-copy"></i> Merge PDFs
    </a>

    <a href="#jsonCsvTxtSection" class="tool-chip">
      <i class="fas fa-code"></i> JSON ⇄ CSV ⇄ TXT
    </a>

    <a href="#formattersSection" class="tool-chip">
      <i class="fas fa-cogs"></i> Format JSON/HTML
    </a>

    <a href="#txtToPdfSection" class="tool-chip">
      <i class="fas fa-file-alt"></i> Text/Word to PDF
    </a>

    <a href="#extractPdfTextSection" class="tool-chip">
      <i class="fas fa-file-contract"></i> PDF to Text
    </a>

    <a href="#wordCountSection" class="tool-chip">
      <i class="fas fa-keyboard"></i> Word Count
    </a>

    <a href="#markdownSection" class="tool-chip">
      <i class="fas fa-file-code"></i> Markdown to HTML/PDF
    </a>

  </div>
</div>

    <div id="mergePdfsSection" class="section">
  <h2 class="text-center mb-3"><i class="fas fa-copy"></i>Merge PDFs</h2>
  
  <input type="file" id="mergePdfInput" class="form-control mb-3" accept="application/pdf" multiple />
  <p class="text-muted small text-center mt-2">
    Recommended: Upload up to 10 PDFs. Each PDF ideally under 30MB. Total combined size under 200MB for best performance.
  </p>

  <div class="d-flex justify-content-center">
    <button onclick="mergePdfs()" class="btn btn-custom">Merge PDFs</button>
  </div>

  <div id="mergePdfPreview" class="mt-4 text-center"></div>
</div>

    
    <div id="jsonCsvTxtSection" class="section">
      <h2 class="text-center mb-3"><i class="fas fa-code"></i>JSON ⇄ CSV ⇄ TXT Conversion</h2>
      <!-- For JSON/CSV/TXT -->
<div class="mb-2">
  <input type="file" id="textFileInput" accept=".json,.csv,.txt" onchange="handleFileUpload('textFileInput','textInput')" />
</div>
      <textarea id="textInput" placeholder="Paste your text here..."></textarea>
      <div class="d-flex flex-wrap gap-2 justify-content-center">
        <button onclick="convertJsonToCsv()" class="btn btn-custom">JSON to CSV</button>
        <button onclick="convertCsvToJson()" class="btn btn-custom">CSV to JSON</button>
        <button onclick="convertJsonToTxt()" class="btn btn-custom">JSON to TXT</button>
        <button onclick="convertTxtToJson()" class="btn btn-custom">TXT to JSON</button>
      </div>
      <div id="textOutput" class="mt-3"></div>
    </div>

    <div id="formattersSection" class="section">
  <h2 class="text-center mb-3"><i class="fas fa-cogs"></i>Format JSON & HTML</h2>

  <textarea id="formatInput" placeholder="Paste JSON or HTML code here..."></textarea>

  <div class="d-flex justify-content-center flex-wrap gap-2 mt-3">
    <button onclick="formatJson()" class="btn btn-custom">Format JSON</button>
    <button onclick="formatHtml()" class="btn btn-custom">Format HTML</button>
  </div>

  <div id="formatOutput" class="p-3 bg-light rounded mt-4" style="min-height:200px; white-space:pre-wrap;"></div>
</div>


    <div id="txtToPdfSection" class="section">
  <h2 class="text-center mb-3"><i class="fas fa-file-alt"></i>Text / Word to PDF Conversion</h2>

  <!-- 上传 TXT 或 DOCX -->
  <input type="file" id="textWordFileInput" class="form-control mb-3" accept=".txt,.docx" onchange="handleTextOrWordUpload()" />

  <textarea id="textInputArea" placeholder="Paste your text here or upload TXT/DOCX..." class="mb-3"></textarea>

  <div class="d-flex justify-content-center flex-wrap gap-2">
    <button onclick="convertTextToPdf()" class="btn btn-custom">Convert Text to PDF</button>
    <div id="textPdfDownload" class="text-center mt-4"></div>

  </div>

  <hr class="my-4">


</div>

    <div id="extractPdfTextSection" class="section">
  <h2 class="text-center mb-3"><i class="fas fa-file-contract"></i>PDF to Text</h2>

  <input type="file" id="pdfToTextInput" class="form-control mb-3" accept="application/pdf" onchange="extractTextFromPdf()" />

  <div id="pdfExtractedText" class="p-3 bg-light rounded" style="min-height:200px;"></div>
</div>

    <div id="wordCountSection" class="section">
  <h2 class="text-center mb-3"><i class="fas fa-keyboard"></i>Word Count</h2>

  <textarea id="wordCountInput" placeholder="Type or paste your text here..."></textarea>

  <div class="mt-3 text-center">
    <p><strong>Characters:</strong> <span id="charCount">0</span></p>
    <p><strong>Words:</strong> <span id="wordCount">0</span></p>
    <p><strong>Lines:</strong> <span id="lineCount">0</span></p>
  </div>
</div>

 
    <div id="markdownSection" class="section">
      <h2 class="text-center mb-3"><i class="fas fa-file-code"></i>Markdown to HTML/PDF Conversion</h2>
      <!-- For Markdown -->
<div class="mb-2">
  <input type="file" id="markdownFileInput" accept=".md,.txt" onchange="handleFileUpload('markdownFileInput','markdownInput')" />
</div>
      <textarea id="markdownInput" placeholder="Paste your Markdown here..."></textarea>
        <div class="d-flex justify-content-center flex-wrap gap-2 mt-3">
  <button onclick="convertMarkdownToHtml()" class="btn btn-custom">Convert Markdown to HTML</button>
  <button onclick="convertMarkdownToPdf()" class="btn btn-custom">Convert Markdown to PDF</button>
</div>

</div>

      <div id="markdownOutput" class="p-3 bg-light rounded mt-3" style="min-height:200px;"></div>

    </div>
  </div>

</div> <!-- End of container -->

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<script>
// --- Tab Switching ---
function showTab(tab) {
  document.getElementById('imageTab').classList.add('hidden');
  document.getElementById('textTab').classList.add('hidden');
  if (tab === 'image') {
    document.getElementById('imageTab').classList.remove('hidden');
  } else {
    document.getElementById('textTab').classList.remove('hidden');
  }
}

// --- Upload File for Text Conversion ---
function handleFileUpload(inputId, textareaId) {
  const file = document.getElementById(inputId).files[0];
  const reader = new FileReader();
  reader.onload = function(e) {
    document.getElementById(textareaId).value = e.target.result;
  };
  reader.readAsText(file);
}

// --- Text Conversions ---
// --- Merge PDFs ---
async function mergePdfs() {
  const input = document.getElementById('mergePdfInput');
  const preview = document.getElementById('mergePdfPreview');
  preview.innerHTML = '';

  if (!input.files.length) {
    alert('Please upload at least two PDF files.');
    return;
  }

  const pdfLibScript = document.createElement('script');
  pdfLibScript.src = "https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js";
  document.head.appendChild(pdfLibScript);

  pdfLibScript.onload = async function() {
    const { PDFDocument } = window.PDFLib;
    const mergedPdf = await PDFDocument.create();

    for (const file of input.files) {
      const arrayBuffer = await file.arrayBuffer();
      const pdf = await PDFDocument.load(arrayBuffer);
      const copiedPages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
      copiedPages.forEach(page => mergedPdf.addPage(page));
    }

    const mergedPdfBytes = await mergedPdf.save();
    const blob = new Blob([mergedPdfBytes], { type: 'application/pdf' });
    const url = URL.createObjectURL(blob);

    const downloadLink = document.createElement('a');
    downloadLink.href = url;
    downloadLink.download = 'merged.pdf';
    downloadLink.className = 'btn btn-custom';
    downloadLink.textContent = 'Download Merged PDF';

    preview.appendChild(downloadLink);
  }
}

// JSON -> CSV
function convertJsonToCsv() {
  try {
    const input = JSON.parse(document.getElementById('textInput').value);
    if (!Array.isArray(input)) {
      alert("Input must be a JSON array (e.g., [{}, {}]) to convert to CSV.");
      return;
    }
    const csvRows = [];
    const headers = Object.keys(input[0]);
    csvRows.push(headers.join(","));
    input.forEach(obj => {
      const values = headers.map(header => JSON.stringify(obj[header] ?? ""));
      csvRows.push(values.join(","));
    });
    document.getElementById('textOutput').innerHTML = `<pre>${csvRows.join("\n")}</pre>`;
  } catch (e) {
    alert("Invalid JSON format.");
  }
}

// CSV -> JSON
function convertCsvToJson() {
  try {
    const csv = document.getElementById('textInput').value.trim();
    const lines = csv.split("\n");
    const headers = lines[0].split(",");
    const json = lines.slice(1).map(line => {
      const values = line.split(",");
      return headers.reduce((obj, header, i) => {
        obj[header] = values[i];
        return obj;
      }, {});
    });
    document.getElementById('textOutput').innerHTML = `<pre>${JSON.stringify(json, null, 2)}</pre>`;
  } catch (e) {
    alert("Invalid CSV format.");
  }
}

// JSON -> TXT
function convertJsonToTxt() {
  try {
    const json = JSON.parse(document.getElementById('textInput').value);
    const txt = JSON.stringify(json, null, 2);
    document.getElementById('textOutput').innerHTML = `<pre>${txt}</pre>`;
  } catch (e) {
    alert("Invalid JSON format.");
  }
}

// TXT -> JSON
function convertTxtToJson() {
  try {
    const txt = document.getElementById('textInput').value;
    const json = JSON.parse(txt);
    document.getElementById('textOutput').innerHTML = `<pre>${JSON.stringify(json, null, 2)}</pre>`;
  } catch (e) {
    alert("Invalid TXT/JSON format.");
  }
}

// --- Text / Word Upload and Convert to PDF ---

function handleTextOrWordUpload() {
  const file = document.getElementById('textWordFileInput').files[0];
  const reader = new FileReader();

  if (file.name.endsWith('.txt')) {
    reader.onload = function(e) {
      document.getElementById('textInputArea').value = e.target.result;
    };
    reader.readAsText(file);
  } else if (file.name.endsWith('.docx')) {
    // Use mammoth.js to parse .docx to text
    const reader = new FileReader();
    reader.onload = function(event) {
      mammoth.extractRawText({ arrayBuffer: event.target.result })
        .then(function(result) {
          document.getElementById('textInputArea').value = result.value;
        })
        .catch(function(err) {
          console.error(err);
          alert("Failed to parse DOCX file.");
        });
    };
    reader.readAsArrayBuffer(file);
  } else {
    alert('Unsupported file type. Please upload TXT or DOCX.');
  }
}

function convertTextToPdf() {
  const text = document.getElementById('textInputArea').value;
  if (!text.trim()) {
    alert('Please enter or upload some text!');
    return;
  }

  const pdf = new jspdf.jsPDF();
  const lines = pdf.splitTextToSize(text, 180);
  pdf.text(lines, 10, 10);

  const blob = pdf.output('blob');
  const url = URL.createObjectURL(blob);

  const link = document.createElement('a');
  link.href = url;
  link.download = 'converted_text.pdf';
  link.className = 'btn btn-custom mt-3';
  link.textContent = 'Download PDF';
  
  // 插入到新的textPdfDownload区
  const preview = document.getElementById('textPdfDownload');
  preview.innerHTML = '';
  preview.appendChild(link);
}


// --- Extract Text from PDF ---

async function extractTextFromPdf() {
  const file = document.getElementById('pdfToTextInput').files[0];
  if (!file) {
    alert('Please upload a PDF file!');
    return;
  }

  const arrayBuffer = await file.arrayBuffer();
  const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
  let fullText = '';

  for (let i = 1; i <= pdf.numPages; i++) {
    const page = await pdf.getPage(i);
    const content = await page.getTextContent();
    const strings = content.items.map(item => item.str).join(' ');
    fullText += strings + '\n\n';
  }

  document.getElementById('pdfExtractedText').textContent = fullText;
}

  // --- Word Count ---
document.getElementById('wordCountInput').addEventListener('input', function() {
  const text = this.value;
  document.getElementById('charCount').textContent = text.length;
  document.getElementById('wordCount').textContent = text.trim() ? text.trim().split(/\s+/).length : 0;
  document.getElementById('lineCount').textContent = text.split('\n').length;
});

  // --- Format JSON ---
function formatJson() {
  const input = document.getElementById('formatInput').value;
  try {
    const obj = JSON.parse(input);
    document.getElementById('formatOutput').textContent = JSON.stringify(obj, null, 2);
  } catch (error) {
    alert('Invalid JSON!');
  }
}

// --- Format HTML ---
function formatHtml() {
  const input = document.getElementById('formatInput').value;
  try {
    const formatted = html_beautify(input, { indent_size: 2 });
    document.getElementById('formatOutput').textContent = formatted;
  } catch (error) {
    alert('Invalid HTML!');
  }
}
  
// Markdown -> HTML
// 实时监听Markdown输入
document.getElementById('markdownInput').addEventListener('input', function() {
  convertMarkdownToHtml();
});

// Markdown -> HTML 转换函数
function convertMarkdownToHtml() {
  const markdown = document.getElementById('markdownInput').value;
  const html = marked.parse(markdown);
  document.getElementById('markdownOutput').innerHTML = html;
}
// --- Markdown to PDF ---
function convertMarkdownToPdf() {
  const markdown = document.getElementById('markdownInput').value;
  if (!markdown.trim()) {
    alert('Please paste or type some Markdown first!');
    return;
  }

  const htmlContent = marked.parse(markdown);

  const container = document.createElement('div');
  container.innerHTML = htmlContent;
  container.style.padding = '20px'; // 小padding防止PDF内容太靠边

  html2pdf()
    .from(container)
    .set({
      margin: 10,
      filename: 'markdown_converted.pdf',
      html2canvas: { scale: 2 },
      jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
    })
    .save();
}

// --- Image Conversions (Compress, Crop, Remove BG, PDF to JPG) ---
function previewSingleImage() {
  const file = document.getElementById("singleFileInput").files[0];
  const format = document.getElementById("singleFormatSelect").value;
  const width = parseInt(document.getElementById("resizeWidth").value);
  const height = parseInt(document.getElementById("resizeHeight").value);
  const preview = document.getElementById("singlePreview");
  const downloadArea = document.getElementById("singleDownload");
  preview.innerHTML = "";
  downloadArea.innerHTML = "";

  if (!file) {
    alert("Please upload an image.");
    return;
  }

  const reader = new FileReader();
  reader.onload = function(e) {
    const img = new Image();
    img.onload = function() {
      const canvas = document.createElement("canvas");
      canvas.width = width || img.width;
      canvas.height = height || img.height;
      canvas.getContext("2d").drawImage(img, 0, 0, canvas.width, canvas.height);

      canvas.toBlob(function(blob) {
        const url = URL.createObjectURL(blob);
        const newImg = new Image();
        newImg.src = url;
        newImg.style.maxWidth = "100%";
        newImg.style.borderRadius = "10px";
        preview.appendChild(newImg);

        const link = document.createElement("a");
        link.href = url;
        link.download = "converted." + format.split("/")[1];
        link.className = "btn btn-custom mt-3";
        link.textContent = "Download Converted Image";
        downloadArea.appendChild(link);
      }, format);
    };
    img.src = e.target.result;
  };
  reader.readAsDataURL(file);
}

function convertBatchImages() {
  const files = document.getElementById("batchFileInput").files;
  const format = document.getElementById("batchFormatSelect").value;
  const width = parseInt(document.getElementById("batchResizeWidth").value);
  const height = parseInt(document.getElementById("batchResizeHeight").value);
  const preview = document.getElementById("batchPreview");
  preview.innerHTML = "";

  if (!files.length) {
    alert("Please upload images.");
    return;
  }

  Array.from(files).forEach(file => {
    const reader = new FileReader();
    reader.onload = function(e) {
      const img = new Image();
      img.onload = function() {
        const canvas = document.createElement("canvas");
        canvas.width = width || img.width;
        canvas.height = height || img.height;
        canvas.getContext("2d").drawImage(img, 0, 0, canvas.width, canvas.height);

        canvas.toBlob(function(blob) {
          const url = URL.createObjectURL(blob);
          const container = document.createElement("div");
          container.className = "img-container";

          const newImg = new Image();
          newImg.src = url;
          newImg.style.maxWidth = "100%";
          newImg.style.borderRadius = "10px";
          container.appendChild(newImg);

          const link = document.createElement("a");
          link.href = url;
          link.download = "converted." + format.split("/")[1];
          link.className = "btn btn-custom mt-2 d-block mx-auto";
          link.textContent = "Download";
          container.appendChild(link);

          preview.appendChild(container);
        }, format);
      };
      img.src = e.target.result;
    };
    reader.readAsDataURL(file);
  });
}

// Compress, Crop, Remove BG, and PDF to JPG
// （这几部分在前面我们已经发过代码，这里继续沿用！）
// --- Compress Image ---
function compressImage() {
  const file = document.getElementById("compressFileInput").files[0];
  const quality = parseFloat(document.getElementById("compressQuality").value);
  const preview = document.getElementById("compressPreview");
  const downloadArea = document.getElementById("compressDownload");
  preview.innerHTML = "";
  downloadArea.innerHTML = "";

  if (!file) {
    alert("Please upload an image.");
    return;
  }

  const reader = new FileReader();
  reader.onload = function(e) {
    const img = new Image();
    img.onload = function() {
      const canvas = document.createElement("canvas");
      canvas.width = img.width;
      canvas.height = img.height;
      canvas.getContext("2d").drawImage(img, 0, 0);

      canvas.toBlob(function(blob) {
        const url = URL.createObjectURL(blob);
        const compressedImg = new Image();
        compressedImg.src = url;
        compressedImg.style.maxWidth = "100%";
        compressedImg.style.borderRadius = "10px";
        preview.appendChild(compressedImg);

        const link = document.createElement("a");
        link.href = url;
        link.download = "compressed.jpg";
        link.className = "btn btn-custom mt-3";
        link.textContent = "Download Compressed Image";
        downloadArea.appendChild(link);
      }, 'image/jpeg', quality);
    };
    img.src = e.target.result;
  };
  reader.readAsDataURL(file);
}

// --- Crop Image with Cropper.js ---
// --- Crop Image (优化版上传即裁剪) ---
let cropper;

document.getElementById("cropFileInput").addEventListener("change", function(event) {
  const file = event.target.files[0];
  const preview = document.getElementById("cropPreview");
  const downloadArea = document.getElementById("cropDownload");
  preview.innerHTML = "";
  downloadArea.innerHTML = "";

  if (!file) {
    alert("Please upload an image.");
    return;
  }

  const reader = new FileReader();
  reader.onload = function(e) {
    const img = new Image();
    img.id = "cropImage";
    img.src = e.target.result;
    img.style.maxWidth = "100%";
    img.style.borderRadius = "10px";
    preview.appendChild(img);

    if (cropper) {
      cropper.destroy();
    }
    cropper = new Cropper(img, {
      aspectRatio: NaN,
      viewMode: 1,
    });
  };
  reader.readAsDataURL(file);
});

function cropImage() {
  const downloadArea = document.getElementById("cropDownload");
  downloadArea.innerHTML = "";

  if (!cropper) {
    alert("Please upload and crop an image first!");
    return;
  }

  const canvas = cropper.getCroppedCanvas();
  canvas.toBlob(function(blob) {
    const url = URL.createObjectURL(blob);
    const link = document.createElement("a");
    link.href = url;
    link.download = "cropped.jpg";
    link.className = "btn btn-custom mt-3";
    link.textContent = "Download Cropped Image";
    downloadArea.appendChild(link);
  }, 'image/jpeg');
}


// --- Create GIF (优化版自动resize+loading提示) ---
function createGif() {
  const files = document.getElementById("gifFileInput").files;
  const delay = parseInt(document.getElementById("gifDelay").value);
  const preview = document.getElementById("gifPreview");
  const downloadArea = document.getElementById("gifDownload");
  preview.innerHTML = "Creating GIF, please wait...";
  downloadArea.innerHTML = "";

  if (!files.length) {
    alert("Please upload multiple images to create a GIF.");
    return;
  }

  const gif = new GIF({
    workers: 2,
    quality: 10,
    workerScript: 'https://cdn.jsdelivr.net/npm/gif.js.optimized/dist/gif.worker.js'
  });

  let loadedImages = 0;
  Array.from(files).forEach(file => {
    const reader = new FileReader();
    reader.onload = function(e) {
      const img = new Image();
      img.onload = function() {
        const canvas = document.createElement("canvas");
        const ctx = canvas.getContext("2d");

        // resize to max 800px width (preserve aspect ratio)
        let maxWidth = 800;
        let ratio = img.width / img.height;
        if (img.width > maxWidth) {
          canvas.width = maxWidth;
          canvas.height = maxWidth / ratio;
        } else {
          canvas.width = img.width;
          canvas.height = img.height;
        }

        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

        gif.addFrame(canvas, { delay: delay });
        loadedImages++;
        if (loadedImages === files.length) {
          gif.render();
        }
      };
      img.src = e.target.result;
    };
    reader.readAsDataURL(file);
  });

  gif.on('finished', function(blob) {
    const url = URL.createObjectURL(blob);
    preview.innerHTML = "";
    const gifImg = new Image();
    gifImg.src = url;
    gifImg.style.maxWidth = "100%";
    gifImg.style.borderRadius = "10px";
    preview.appendChild(gifImg);

    const link = document.createElement("a");
    link.href = url;
    link.download = "created.gif";
    link.className = "btn btn-custom mt-3";
    link.textContent = "Download GIF";
    downloadArea.appendChild(link);
  });
}

// --- Resize Image ---

function resizeImage() {
  const fileInput = document.getElementById('resizeImageInput');
  const width = parseInt(document.getElementById('resizeWidthInput').value);
  const height = parseInt(document.getElementById('resizeHeightInput').value);
  const preview = document.getElementById('resizeImagePreview');

  preview.innerHTML = '';

  if (!fileInput.files.length || !width || !height) {
    alert('Please upload an image and specify width and height.');
    return;
  }

  const reader = new FileReader();
  reader.onload = function(event) {
    const img = new Image();
    img.onload = function() {
      const canvas = document.createElement('canvas');
      canvas.width = width;
      canvas.height = height;
      const ctx = canvas.getContext('2d');
      ctx.drawImage(img, 0, 0, width, height);

      const resizedDataUrl = canvas.toDataURL('image/jpeg');

      const resizedImg = new Image();
      resizedImg.src = resizedDataUrl;
      resizedImg.className = 'img-fluid rounded mb-3';
      preview.appendChild(resizedImg);

      const link = document.createElement('a');
      link.href = resizedDataUrl;
      link.download = 'resized_image.jpg';
      link.className = 'btn btn-custom';
      link.textContent = 'Download Resized Image';
      preview.appendChild(link);
    };
    img.src = event.target.result;
  };
  reader.readAsDataURL(fileInput.files[0]);
}
  
  
// --- Images to PDF ---

function convertImagesToPdf() {
  const input = document.getElementById('imagesPdfInput');
  const preview = document.getElementById('imagesPdfPreview');
  preview.innerHTML = '';

  if (!input.files.length) {
    alert('Please upload some images.');
    return;
  }

  const pdf = new jspdf.jsPDF();
  let filesProcessed = 0;

  Array.from(input.files).forEach((file, index) => {
    const reader = new FileReader();
    reader.onload = function(event) {
      const img = new Image();
      img.onload = function() {
        const imgWidth = 210; // A4宽度（mm）
        const imgHeight = (img.height * imgWidth) / img.width;

        if (index !== 0) {
          pdf.addPage();
        }
        pdf.addImage(img, 'JPEG', 0, 0, imgWidth, imgHeight);

        // 同时预览小图
        const smallPreview = new Image();
        smallPreview.src = event.target.result;
        smallPreview.style.maxWidth = '120px';
        smallPreview.style.margin = '5px';
        preview.appendChild(smallPreview);

        filesProcessed++;
        if (filesProcessed === input.files.length) {
          pdf.save('images_converted.pdf');
        }
      };
      img.src = event.target.result;
    };
    reader.readAsDataURL(file);
  });
}



// --- PDF to JPG ---
function convertPdfToJpg() {
  const file = document.getElementById("pdfFileInput").files[0];
  const preview = document.getElementById("pdfPreview");
  const downloadArea = document.getElementById("pdfDownload");
  preview.innerHTML = "";
  downloadArea.innerHTML = "";

  if (!file) {
    alert("Please upload a PDF.");
    return;
  }

  const reader = new FileReader();
  reader.onload = function(e) {
    const pdfData = new Uint8Array(e.target.result);
    pdfjsLib.getDocument({ data: pdfData }).promise.then(function(pdf) {
      pdf.getPage(1).then(function(page) {
        const viewport = page.getViewport({ scale: 2.0 });
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        canvas.height = viewport.height;
        canvas.width = viewport.width;

        const renderContext = {
          canvasContext: ctx,
          viewport: viewport
        };
        page.render(renderContext).promise.then(function() {
          canvas.toBlob(function(blob) {
            const url = URL.createObjectURL(blob);
            const pdfImg = new Image();
            pdfImg.src = url;
            pdfImg.style.maxWidth = "100%";
            pdfImg.style.borderRadius = "10px";
            preview.appendChild(pdfImg);

            const link = document.createElement("a");
            link.href = url;
            link.download = "pdf-page.jpg";
            link.className = "btn btn-custom mt-3";
            link.textContent = "Download JPG";
            downloadArea.appendChild(link);
          }, 'image/jpeg');
        });
      });
    });
  };
  reader.readAsArrayBuffer(file);
}

function performOcr() {
  const fileInput = document.getElementById('ocrFileInput');
  const resultDiv = document.getElementById('ocrResult');

  if (fileInput.files.length === 0) {
    resultDiv.innerHTML = '<p class="text-danger">Please upload an image file first.</p>';
    return;
  }

  resultDiv.innerHTML = '<p class="text-info">Extracting text... Please wait.</p>';

  const file = fileInput.files[0];
  const reader = new FileReader();

  reader.onload = function(e) {
    Tesseract.recognize(
      e.target.result,
      'eng+chi_sim', // 中英文混合支持
      {
        logger: m => console.log(m) // 可选：显示进度
      }
    ).then(({ data: { text } }) => {
      resultDiv.innerText = text.trim();
    }).catch(err => {
      console.error(err);
      resultDiv.innerHTML = '<p class="text-danger">Error during OCR. Please try again.</p>';
    });
  };

  reader.readAsDataURL(file);
}


</script>

<footer>
  © 2025 QuickConvert. All rights reserved.
</footer>

</body>
</html>
